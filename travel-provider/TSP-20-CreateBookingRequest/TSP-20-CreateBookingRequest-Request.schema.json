{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "type": "object",
  "title": "TSP-20-CreateBookingRequest Request Schema",
  "version": "1.0.0",
  "description": "Schema for travel booking request sent to travel provider",
  "properties": {
    "companyId":
    {
      "type": "string",
      "enum":
      [
        "Home Office",
        "BPMS",
        "SHELL VPOB"
      ]
    },
    "travelType":
    {
      "description": "Type of travel booking request",
      "type": "string",
      "enum":
      [
        "Flight",
        "Hotel",
        "Ferry",
        "Car"
      ],
      "default": "Flight"
    },
    "actionType":
    {
      "description": "Identifies if the booking is a New, Update OR Cancel",
      "type": "string",
      "enum":
      [
        "New",
        "Update",
        "Cancel"
      ],
      "default": "New"
    },
    "requestId":
    {
      "type": "integer",
      "description": "Entity Id for this booking - generated by the HO to uniquely identify this booking in all the correspondence"
    },
    "bookingType":
    {
      "type": "string",
      "description": "Identifies the kind of booking selected by the caseworker e.g. Individual, Group, Family, EscortOnlyIndividual, EscortOnlyFamily"
    },
    "key":
    {
      "description": "Unique key to identify the travel request wihtin the HO systems e.g. HO sdid",
      "type": "string"
    },
    "reference":
    {
      "description": "Home Office Reference e.g. Person Id, Port Reference OR CEPR of the detainee",
      "type": "string"
    },
    "requestAuthoriser":
    {
      "description": "Details of the case worker initiating the travel request",
      "type": "object",
      "properties":
      {
        "name":
        {
          "type": "string"
        },
        "email":
        {
          "description": "Personal email address of the caseworker if available",
          "type": "string"
        },
        "telephone":
        {
          "description": "Telephone number of the caseworker if available",
          "type": "string"
        },
        "requestDate":
        {
          "description": "Date when the request was raised",
          "type": "string"
        },
        "teamEmail":
        {
          "description": "Group email of the team to which the requester belongs",
          "type": "string"
        },
        "teamTelephone":
        {
          "description": "Group telephone of the requester",
          "type": "string"
        },
        "teamName":
        {
          "description": "This will have both Group name to contact if named contact is not available and the Group code of the team to which the requester belongs",
          "type": "string"
        }
      },
      "anyOf":
      [
        {
          "description": "Constraints requiring either personal or team contact details to be provided.",
          "required":
          [
            "name",
            "email",
            "telephone"
          ]
        },
        {
          "description": "Constraints requiring either personal or team contact details to be provided.",
          "required":
          [
            "name",
            "teamEmail",
            "teamTelephone"
          ]
        }
      ]
    },
    "travelers":
    {
      "type": "array",
      "items":
      {
        "type": "object",
        "properties":
        {
          "isDetained":
          {
            "type": "boolean",
            "description": "Indicates if the person is detained"
          },
          "placeOfDetention":
          {
            "$ref": "#/definitions/placeOfDetention"
          }
        },
        "required":
        [
          "isDetained"
        ],
        "additionalProperties": false,
        "description": "Whether or not the traveler is is detention and details about the place of detention"
      }
    },
    "complexCaseDetails":
    {
      "type": "object",
      "properties":
      {
        "complexCase":
        {
          "type": "string",
          "description": "This will indicate whether or not Complex case team is handling this booking"
        },
        "complexCaseComments":
        {
          "type": "string",
          "description": "Complex case information (free text)"
        }
      },
      "additionalProperties": false,
      "required":
      [
        "complexCase"
      ]
    },
    "riskInformation":
    {
      "description": "Risks associated with the Traveler and other details",
      "properties":
      {
        "risks":
        {
          "type": "array",
          "description": "List of risks",
          "minItems": 1,
          "items":
          {
            "type": "string",
            "description": "Risk information e.g. Self harm, Suicide, Escape, Food Refusal, Medical etc "
          }
        },
        "details":
        {
          "type": "string",
          "description": "These are specific details entered by the Caseworker for the Escort and Travel Team about the Risks"
        }
      },
      "additionalProperties": false
    },
    "previousFailedReturn":
    {
      "type": "object",
      "properties":
      {
        "date":
        {
          "type": "string",
          "pattern": "^\\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$",
          "description": "Date in the ISO-8601 format yyyy-MM-dd."
        },
        "reason":
        {
          "type": "string",
          "description": "Details about the failed return"
        }
      },
      "additionalProperties": false,
      "required":
      [
        "date",
        "reason"
      ]
    },
    "flights":
    {
      "description": "Flight details",
      "type": "object",
      "properties":
      {
        "routeType":
        {
          "description": "Flight route type",
          "type": "string",
          "default": "OneWay"
        },
        "routingConsiderations":
        {
          "description": "Free Text ",
          "type": "string"
        },
        "refundableTickets":
        {
          "type": "boolean",
          "description": "Whether or not flight tickets should be refundable"
        },
        "extraInformation":
        {
          "description": "Any other information pertinent to the quote request - Free Text",
          "type": "string"
        },
        "flightClass":
        {
          "description": "Type of travel Class",
          "type": "string",
          "enum":
          [
            "Economy",
            "Premium Economy",
            "Business",
            "First",
            "Others"
          ],
          "default": "Economy"
        },
        "flightDetails":
        {
          "type": "object",
          "properties":
          {
            "flightNumber":
            {
              "description": "Number of the flight if known",
              "type": "string"
            },
            "departureAirport":
            {
              "description": "Description of departure airport",
              "type": "string"
            },
            "departureAirportCode":
            {
              "description": "IATA code of the departure airport",
              "type": "string"
            },
            "preferredDepartureDate":
            {
              "description": "Earliest date by which the traveler should depart - in ISO-8601 format of yyyy-MM-dd",
              "type": "string",
              "pattern": "^\\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$"
            },
            "latestDepartureDate":
            {
              "description": "Latest date by which the traveler should depart - in ISO-8601 format of yyyy-MM-dd",
              "type": "string",
              "pattern": "^\\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$"
            },
            "dayRestrictions":
            {
              "$ref": "#/definitions/restriction",
              "description": "Details of any days that they cannot travel on (free text)"
            },
            "preferredDepartureTimeRestrictions":
            {
              "$ref": "#/definitions/restriction",
              "description": "Restrictions to arrival/departure times (free text)"
            },
            "arrivalTimeTimeRestrictions":
            {
              "$ref": "#/definitions/restriction",
              "description": "Restrictions to arrival/departure times (free text)"
            },
            "transitRestrictions":
            {
              "$ref": "#/definitions/restriction",
              "description": "Transit country restrictions"
            },
            "airlineRestrictions":
            {
              "$ref": "#/definitions/restriction",
              "description": "Restrictions on which airlines that can be used"
            },
            "specificFlights":
            {
              "$ref": "#/definitions/specificFlights",
              "description": "The details of specific flights"
            },
            "preferredDepartureTime":
            {
              "description": "Preferred time of departure",
              "type": "string"
            },
            "arrivalAirport":
            {
              "description": "Description of the arrival airport",
              "type": "string"
            },
            "arrivalAirportCode":
            {
              "description": "IATA code of the arrival airport",
              "type": "string"
            },
            "arrivalDate":
            {
              "description": "Date by which the traveler should arrive at the destination - in ISO-8601 format of yyyy-MM-dd",
              "type": "string",
              "pattern": "^\\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$"
            },
            "preferredArrivalTime":
            {
              "description": "Preferred time of arrival",
              "type": "string"
            },
            "travelTimeConstraintType":
            {
              "description": "Time preference on when the flight should be booked",
              "type": "string"
            }
          },
          "required":
          [
            "departureAirport",
            "arrivalAirport",
            "preferredDepartureDate"
          ]
        }
      },
      "required":
      [
        "flightClass",
        "refundableRequired",
        "flightDetails"
      ]
    },
    "specificFlights":
    {
      "type": "object",
      "properties":
      {
        "departureDate":
        {
          "type": "string",
          "description": "Departure date of the specific flights"
        },
        "specificFlightNumbers":
        {
          "type": "string",
          "description": "Specific flight and airlines details"
        }
      },
      "additionalProperties": false,
      "required":
      [
        "specificFlightNumbers",
        "departureDate"
      ]
    },
    "vessel":
    {
      "type": "object",
      "properties":
      {
        "vesselName":
        {
          "description": "Name of the vessel",
          "type": "string"
        },
        "vesselFlag":
        {
          "type": "string"
        },
        "portName":
        {
          "description": "Port where the vessel starts",
          "type": "string"
        },
        "costCenter":
        {
          "description": "Cost Center to which the booking is chargeable",
          "type": "string"
        }
      }
    }
  },
  "required": [
    "companyId",
    "travelType",
    "actionType",
    "requestId",
    "bookingType",
    "key",
    "reference",
    "travelers",
    "flights",
    "requestAuthoriser"
  ],
  "definitions": {
    "placeOfDetention": {
      "type": "object",
      "properties": {
        "location": {
          "type": "string",
          "description": "Place where the person in detained"
        },
        "details": {
          "type": "string",
          "description": "Details about the detention"
        }
      },
      "additionalProperties": false,
      "required": [ "location" ]
    },
    "restriction": {
      "type": "object",
      "properties": {
        "isRestricted": {
          "type": "boolean",
          "description": "Whether or not restriction applies to this quote request"
        },
        "information": {
          "type": "string",
          "description": "Restrictions information (free text)"
        }
      },
      "additionalProperties": false,
      "required": [ "isRestricted" ]
    },
    "specificFlights": {
      "type": "object",
      "properties": {
        "specificFlightNumbers": {
          "type": "string",
          "description": "Specific flight and airlines details"
        },
        "departureDate": {
          "type": "string",
          "description": "Departure date of the specific flights"
        }
      },
      "additionalProperties": false,
      "required": [ "specificFlightNumbers", "departureDate" ]
    }
  }
}